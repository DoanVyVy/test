package com.example.action;

import java.util.Iterator;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.struts.action.Action;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;
import org.apache.struts.tiles.Definition;
import org.apache.struts.tiles.TilesUtil;

public class T001Action extends Action {

    @Override
    public ActionForward execute(ActionMapping mapping, ActionForm form,
                                 HttpServletRequest request, HttpServletResponse response)
                                 throws Exception {
        // Lấy định nghĩa tile hiện hành thông qua TilesUtil của Struts
        Definition def = TilesUtil.getCurrentDefinition(request);
        if (def != null) {
            Map attributes = def.getAttributes();
            if (attributes != null && !attributes.isEmpty()) {
                Iterator it = attributes.entrySet().iterator();
                while (it.hasNext()) {
                    Map.Entry entry = (Map.Entry) it.next();
                    System.out.println("Tiles Attribute: " + entry.getKey() + " = " + entry.getValue());
                }
            } else {
                System.out.println("Không tìm thấy thuộc tính nào trong định nghĩa Tiles hiện hành.");
            }
        } else {
            System.out.println("Không tìm thấy định nghĩa Tiles hiện hành.");
        }
        // Tiếp tục xử lý Action, ví dụ forward tới "success"
        return mapping.findForward("success");
    }
}
